<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HgCdTe Zincblende Structure (2x2x2 Supercell)</title>
    <style>
        /* Basic styling for the viewer container */
        #viewer-container {
            height: 600px;
            width: 95%;
            max-width: 700px;
            border: 1px solid lightgray;
            position: relative;
            margin: 20px auto;
        }
    </style>
</head>
<body>

<h1>HgCdTe (Zincblende) Structure - 2x2x2 Supercell</h1>
<p>Ball-and-stick model. Legend: Te (Yellow), Hg (Grey), Cd (Blue)</p>

<!-- This div will hold the 3Dmol.js viewer -->
<div id="viewer-container"></div>

<!-- Include 3Dmol.js library from CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.1.0/3Dmol-min.js"
        integrity="sha512-7+jpQprKBlgz3G5m9L70sa3b51rBx5VxBAvVLKfHgOfw3VmfmRp7zdfeBbuDBCwrS/mObsJxMT1yketh0gEkIw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
    document.addEventListener("DOMContentLoaded", function() {

        // --- Configuration ---
        const lattice_a = 6.47; // Angstroms
        const supercell_dim = 2;

        // --- Base Unit Cell Atoms (Fractional Coordinates) ---
        const baseAtoms = [
            { element: 'Te', fx: 0.00, fy: 0.00, fz: 0.00 },
            { element: 'Te', fx: 0.00, fy: 0.50, fz: 0.50 },
            { element: 'Te', fx: 0.50, fy: 0.00, fz: 0.50 },
            { element: 'Te', fx: 0.50, fy: 0.50, fz: 0.00 },
            { element: 'Hg', fx: 0.25, fy: 0.25, fz: 0.25 },
            { element: 'Cd', fx: 0.25, fy: 0.75, fz: 0.75 },
            { element: 'Hg', fx: 0.75, fy: 0.25, fz: 0.75 },
            { element: 'Cd', fx: 0.75, fy: 0.75, fz: 0.25 }
        ];

        // --- Generate Supercell Coordinates (XYZ format string) ---
        let xyzBuilder = [];
        let totalAtoms = 0;
        for (let nx = 0; nx < supercell_dim; nx++) {
            for (let ny = 0; ny < supercell_dim; ny++) {
                for (let nz = 0; nz < supercell_dim; nz++) {
                    baseAtoms.forEach(atom => {
                        let x = (atom.fx + nx) * lattice_a;
                        let y = (atom.fy + ny) * lattice_a;
                        let z = (atom.fz + nz) * lattice_a;
                        xyzBuilder.push(`${atom.element} ${x.toFixed(4)} ${y.toFixed(4)} ${z.toFixed(4)}`);
                        totalAtoms++;
                    });
                }
            }
        }
        const xyzData = `${totalAtoms}\nHg0.5Cd0.5Te ${supercell_dim}x${supercell_dim}x${supercell_dim} Supercell (a=${lattice_a} A)\n` + xyzBuilder.join('\n');

        // --- 3Dmol.js Viewer Setup ---
        let viewerElement = document.getElementById('viewer-container');
        let viewer = $3Dmol.createViewer(viewerElement, { backgroundColor: 'white' });

        // Load the atomic data
        let model = viewer.addModel(xyzData, 'xyz');

        // ** Crucial part for Ball-and-Stick **
        // Apply styles: Make spheres smaller and sticks reasonably thick
        // 3Dmol automatically computes bonds based on distances when both styles are present.
        viewer.setStyle({}, {
            stick: { radius: 0.15, colorscheme: 'element' }, // Adjust radius as needed
            sphere: { scale: 0.25, colorscheme: 'element' }   // Reduced scale for spheres
        });

        // Override default element colors for clarity
        viewer.setStyle({elem:'Te'}, {sphere:{color:'yellow'}, stick:{color:'yellow'}});
        viewer.setStyle({elem:'Hg'}, {sphere:{color:'grey'},   stick:{color:'grey'}});
        viewer.setStyle({elem:'Cd'}, {sphere:{color:'blue'},   stick:{color:'blue'}});

        // Zoom camera to fit the model
        viewer.zoomTo();

        // Draw the scene
        viewer.render();

        // Optional: Spin the model
        // viewer.spin(true);

    }); // End DOMContentLoaded
</script>

</body>
</html>
