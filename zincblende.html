<!DOCTYPE html>
<html>
<head>
  <title>HgCdTe Zincblende Structure</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://3Dmol.csb.pitt.edu/build/3Dmol-min.js"></script>
  <style>
    .mol-container {
      width: 100%;
      height: 400px;
      position: relative;
    }
    .controls {
      margin: 20px 0;
    }
    button {
      margin: 5px;
      padding: 8px 16px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a049;
    }
  </style>
</head>
<body>
  <h2>2×2×2 HgCdTe Zincblende Structure</h2>
  <div class="controls">
    <button id="sphere">Sphere</button>
    <button id="stick">Stick</button>
    <button id="ball-stick">Ball and Stick</button>
    <button id="line">Line</button>
    <button id="cross">Cross</button>
  </div>
  <div id="container" class="mol-container"></div>
  
  <script>
    $(document).ready(function() {
      // Initialize viewer
      let element = $('#container');
      let config = { backgroundColor: 'white' };
      let viewer = $3Dmol.createViewer(element, config);
      
      // Lattice constant for HgCdTe (approximated)
      const a = 6.5; 
      
      // Create a 2x2x2 unit cell
      let atoms = [];
      
      // Function to add atoms to the cell
      function addAtom(x, y, z, elem) {
        atoms.push({
          "elem": elem,
          "x": x,
          "y": y,
          "z": z
        });
      }
      
      // Generate the 2x2x2 zincblende structure
      for (let i = 0; i < 2; i++) {
        for (let j = 0; j < 2; j++) {
          for (let k = 0; k < 2; k++) {
            // Base positions within a unit cell
            const baseX = i * a;
            const baseY = j * a;
            const baseZ = k * a;
            
            // Group 1: Hg at (0,0,0), (0,0.5,0.5), (0.5,0,0.5), (0.5,0.5,0)
            addAtom(baseX + 0,     baseY + 0,     baseZ + 0,     'Hg');
            addAtom(baseX + 0,     baseY + 0.5*a, baseZ + 0.5*a, 'Hg');
            addAtom(baseX + 0.5*a, baseY + 0,     baseZ + 0.5*a, 'Hg');
            addAtom(baseX + 0.5*a, baseY + 0.5*a, baseZ + 0,     'Hg');
            
            // Group 2: Cd at positions similar to Hg but with probability (for visual distinction)
            // In reality these would be randomly distributed Hg/Cd sites
            if (Math.random() < 0.5) {
              addAtom(baseX + 0.25*a, baseY + 0.25*a, baseZ + 0.25*a, 'Cd');
              addAtom(baseX + 0.25*a, baseY + 0.75*a, baseZ + 0.75*a, 'Cd');
              addAtom(baseX + 0.75*a, baseY + 0.25*a, baseZ + 0.75*a, 'Cd');
              addAtom(baseX + 0.75*a, baseY + 0.75*a, baseZ + 0.25*a, 'Cd');
            } else {
              addAtom(baseX + 0.25*a, baseY + 0.25*a, baseZ + 0.25*a, 'Hg');
              addAtom(baseX + 0.25*a, baseY + 0.75*a, baseZ + 0.75*a, 'Hg');
              addAtom(baseX + 0.75*a, baseY + 0.25*a, baseZ + 0.75*a, 'Hg');
              addAtom(baseX + 0.75*a, baseY + 0.75*a, baseZ + 0.25*a, 'Hg');
            }
            
            // Te atoms at tetrahedral positions
            addAtom(baseX + 0.75*a, baseY + 0.75*a, baseZ + 0.75*a, 'Te');
            addAtom(baseX + 0.75*a, baseY + 0.25*a, baseZ + 0.25*a, 'Te');
            addAtom(baseX + 0.25*a, baseY + 0.75*a, baseZ + 0.25*a, 'Te');
            addAtom(baseX + 0.25*a, baseY + 0.25*a, baseZ + 0.75*a, 'Te');
          }
        }
      }
      
      // Create model with the atoms
      let m = viewer.addModel();
      for (let atom of atoms) {
        m.addAtom(atom);
      }
      
      // Calculate and add bonds
      m.addBonds({
        atomPair: calculateBonds(atoms),
        bondOrder: 1
      });
      
      // Function to calculate bonds based on distance
      function calculateBonds(atoms) {
        let bonds = [];
        const bondThreshold = 3.5; // Adjust based on your desired bond length
        
        for (let i = 0; i < atoms.length; i++) {
          for (let j = i + 1; j < atoms.length; j++) {
            const a1 = atoms[i];
            const a2 = atoms[j];
            
            // Calculate distance
            const dx = a1.x - a2.x;
            const dy = a1.y - a2.y;
            const dz = a1.z - a2.z;
            const dist = Math.sqrt(dx*dx + dy*dy + dz*dz);
            
            // Only bond if atoms are close enough
            if (dist < bondThreshold) {
              bonds.push({
                indices: [i, j],
                order: 1
              });
            }
          }
        }
        
        return bonds;
      }
      
      // Set atom styles and render
      setStyle('ball-stick');
      
      // Buttons for different visualization styles
      $('#sphere').click(function() { setStyle('sphere'); });
      $('#stick').click(function() { setStyle('stick'); });
      $('#ball-stick').click(function() { setStyle('ball-stick'); });
      $('#line').click(function() { setStyle('line'); });
      $('#cross').click(function() { setStyle('cross'); });
      
      function setStyle(style) {
        if (style === 'sphere') {
          m.setStyle({}, {sphere: {scale: 0.7}});
        } else if (style === 'stick') {
          m.setStyle({}, {stick: {radius: 0.2}});
        } else if (style === 'ball-stick') {
          m.setStyle({}, {sphere: {scale: 0.3}, stick: {radius: 0.15}});
        } else if (style === 'line') {
          m.setStyle({}, {line: {}});
        } else if (style === 'cross') {
          m.setStyle({}, {cross: {lineWidth: 5}});
        }
        
        // Set atom colors
        m.setStyle({elem: 'Hg'}, {color: '0x808080'}); // Gray for mercury
        m.setStyle({elem: 'Cd'}, {color: '0xFFD700'}); // Gold for cadmium
        m.setStyle({elem: 'Te'}, {color: '0x8B4513'}); // Brown for tellurium
        
        viewer.zoomTo();
        viewer.render();
      }
      
      // Add unit cell box
      let cellBox = {
        corner: {x: 0, y: 0, z: 0},
        dimensions: {w: 2*a, h: 2*a, d: 2*a}
      };
      viewer.addBox(cellBox);
      
      // Set initial view
      viewer.setView([0, 0, 0, 1]);
      viewer.zoom(0.8);
      viewer.rotate(20, 'y');
      viewer.rotate(30, 'x');
      viewer.render();
    });
  </script>
</body>
</html>
