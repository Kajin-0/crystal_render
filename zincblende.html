<!DOCTYPE html>
<html>
<head>
    <title>HgCdTe Zinc-Blende Structure Visualization</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/3Dmol.js/2.0.0/3Dmol-min.js"></script>
    <style>
        #container {
            width: 100%;
            height: 400px;
            position: relative;
        }
        .controls {
            margin: 10px 0;
            padding: 10px;
            background-color: #f0f0f0;
            border-radius: 5px;
        }
        .info {
            margin: 10px 0;
            padding: 10px;
            background-color: #e0f0ff;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="info">
        <h2>HgCdTe (Hg<sub>1-x</sub>Cd<sub>x</sub>Te) Zinc-Blende Structure</h2>
        <p>Lattice constant: 6.46 Å (for x ≈ 0.3, varies with composition)</p>
        <p>Space group: F43m (zinc-blende/sphalerite structure)</p>
    </div>
    
    <div id="container"></div>
    
    <div class="controls">
        <button id="showUnitCell">Toggle Unit Cell</button>
        <button id="showPolyhedra">Toggle Polyhedra</button>
        <button id="showBonds">Toggle Bonds</button>
        <label>
            Style:
            <select id="styleSelect">
                <option value="sphere">Sphere</option>
                <option value="stick">Stick</option>
                <option value="line">Line</option>
                <option value="cross">Cross</option>
            </select>
        </label>
        <button id="resetView">Reset View</button>
    </div>
    
    <script>
        $(document).ready(function() {
            // Initialize 3Dmol viewer
            let element = $("#container");
            let config = { backgroundColor: 'white' };
            let viewer = $3Dmol.createViewer(element, config);
            
            // HgCdTe parameters (zinc-blende structure)
            // Lattice constant for Hg0.7Cd0.3Te is approximately 6.46 Å
            const latticeConstant = 6.46;
            
            // Function to create the HgCdTe zinc-blende structure
            function createHgCdTeStructure() {
                // Create a model to hold all the atoms
                let m = viewer.addModel();
                
                // Define atom colors and radii
                const atomColors = {
                    "Hg": "silver",
                    "Cd": "goldenrod",
                    "Te": "darkred"
                };
                
                const atomRadii = {
                    "Hg": 1.49,
                    "Cd": 1.44,
                    "Te": 1.37
                };
                
                // Zinc-blende structure has a face-centered cubic lattice
                // with two atom types (here Hg/Cd and Te)
                
                // Define the unit cell
                const a = latticeConstant;
                
                // Position of atoms within a single unit cell
                // Hg/Cd positions - FCC lattice sites
                const metalPositions = [
                    [0, 0, 0],
                    [0, 0.5*a, 0.5*a],
                    [0.5*a, 0, 0.5*a],
                    [0.5*a, 0.5*a, 0]
                ];
                
                // Te positions - shifted by (0.25, 0.25, 0.25) from metal positions
                const tePositions = [
                    [0.25*a, 0.25*a, 0.25*a],
                    [0.25*a, 0.75*a, 0.75*a],
                    [0.75*a, 0.25*a, 0.75*a],
                    [0.75*a, 0.75*a, 0.25*a]
                ];
                
                // Add metal atoms (70% Hg, 30% Cd random distribution)
                metalPositions.forEach(pos => {
                    const element = Math.random() < 0.7 ? "Hg" : "Cd";
                    m.addAtom({
                        elem: element,
                        x: pos[0],
                        y: pos[1],
                        z: pos[2],
                        color: atomColors[element],
                        radius: atomRadii[element] * 0.5  // Scale radius for better visualization
                    });
                });
                
                // Add Te atoms
                tePositions.forEach(pos => {
                    m.addAtom({
                        elem: "Te",
                        x: pos[0],
                        y: pos[1],
                        z: pos[2],
                        color: atomColors["Te"],
                        radius: atomRadii["Te"] * 0.5  // Scale radius for better visualization
                    });
                });
                
                // Add unit cell box
                viewer.addUnitCell({
                    a: a,
                    b: a,
                    c: a,
                    alpha: 90,
                    beta: 90,
                    gamma: 90
                });
                
                // Add bonds between Hg/Cd and Te
                // In zinc-blende structure, each atom has 4 nearest neighbors
                const bondCutoff = 3.0; // Å, adjusted for this structure
                m.addBonds({
                    threshold: bondCutoff,
                    colormode: "color1"
                });
                
                return m;
            }
            
            // Create the structure
            let model = createHgCdTeStructure();
            
            // Set initial style
            viewer.setStyle({}, {sphere: {scale: 0.5}});
            viewer.addStyle({elem: "Hg"}, {sphere: {color: "silver", scale: 0.5}});
            viewer.addStyle({elem: "Cd"}, {sphere: {color: "goldenrod", scale: 0.5}});
            viewer.addStyle({elem: "Te"}, {sphere: {color: "darkred", scale: 0.5}});
            
            // Set initial view
            viewer.zoomTo();
            viewer.render();
            
            // Set up controls
            let unitCellVisible = true;
            $("#showUnitCell").click(function() {
                unitCellVisible = !unitCellVisible;
                if (unitCellVisible) {
                    viewer.addUnitCell({
                        a: latticeConstant,
                        b: latticeConstant,
                        c: latticeConstant,
                        alpha: 90,
                        beta: 90,
                        gamma: 90
                    });
                } else {
                    viewer.removeUnitCell();
                }
                viewer.render();
            });
            
            $("#showPolyhedra").click(function() {
                model.addSurface($3Dmol.SurfaceType.VDW, {
                    opacity: 0.7,
                    color: "white"
                }, {
                    elem: "Te"
                });
                viewer.render();
            });
            
            let bondsVisible = true;
            $("#showBonds").click(function() {
                bondsVisible = !bondsVisible;
                if (bondsVisible) {
                    model.addBonds({
                        threshold: 3.0,
                        colormode: "color1"
                    });
                } else {
                    model.removeBonds();
                }
                viewer.render();
            });
            
            $("#styleSelect").change(function() {
                const style = $(this).val();
                switch(style) {
                    case "sphere":
                        viewer.setStyle({}, {sphere: {scale: 0.5}});
                        break;
                    case "stick":
                        viewer.setStyle({}, {stick: {}});
                        break;
                    case "line":
                        viewer.setStyle({}, {line: {}});
                        break;
                    case "cross":
                        viewer.setStyle({}, {cross: {linewidth: 5}});
                        break;
                }
                viewer.render();
            });
            
            $("#resetView").click(function() {
                viewer.zoomTo();
                viewer.render();
            });
        });
    </script>
</body>
</html>
