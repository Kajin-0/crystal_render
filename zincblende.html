<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HgCdTe Zincblende Structure (2x2x2 Supercell)</title>
    <style>
        /* Basic styling for the viewer container */
        #viewer-container {
            height: 600px; /* Increased height for larger model */
            width: 95%;
            max-width: 700px; /* Increased max-width */
            border: 1px solid lightgray;
            position: relative;
            margin: 20px auto;
        }
    </style>
</head>
<body>

<h1>HgCdTe (Zincblende) Structure - 2x2x2 Supercell</h1>
<p>Ball-and-stick model. Legend: Te (Yellow), Hg (Grey), Cd (Blue)</p>

<!-- This div will hold the 3Dmol.js viewer -->
<div id="viewer-container"></div>

<!-- Include 3Dmol.js library from CDN -->
<!-- IMPORTANT: Using the corrected integrity hash -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.1.0/3Dmol-min.js"
        integrity="sha512-7+jpQprKBlgz3G5m9L70sa3b51rBx5VxBAvVLKfHgOfw3VmfmRp7zdfeBbuDBCwrS/mObsJxMT1yketh0gEkIw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
    // Wait for the page elements to load
    document.addEventListener("DOMContentLoaded", function() {

        // --- Configuration ---
        const lattice_a = 6.47; // Approx. lattice constant for Hg0.5Cd0.5Te (Angstroms)
        const supercell_dim = 2; // We want a 2x2x2 supercell

        // --- Base Unit Cell Atoms (Fractional Coordinates) ---
        // Defines the 8 atoms within ONE unit cell
        const baseAtoms = [
            { element: 'Te', fx: 0.00, fy: 0.00, fz: 0.00 },
            { element: 'Te', fx: 0.00, fy: 0.50, fz: 0.50 },
            { element: 'Te', fx: 0.50, fy: 0.00, fz: 0.50 },
            { element: 'Te', fx: 0.50, fy: 0.50, fz: 0.00 },
            { element: 'Hg', fx: 0.25, fy: 0.25, fz: 0.25 }, // Ordered approx for Hg0.5Cd0.5Te
            { element: 'Cd', fx: 0.25, fy: 0.75, fz: 0.75 },
            { element: 'Hg', fx: 0.75, fy: 0.25, fz: 0.75 },
            { element: 'Cd', fx: 0.75, fy: 0.75, fz: 0.25 }
        ];

        // --- Generate Supercell Coordinates (XYZ format string) ---
        let xyzBuilder = [];
        let totalAtoms = 0;

        // Loop through the supercell dimensions
        for (let nx = 0; nx < supercell_dim; nx++) {
            for (let ny = 0; ny < supercell_dim; ny++) {
                for (let nz = 0; nz < supercell_dim; nz++) {
                    // Add each atom from the base cell, shifted by the cell indices (nx, ny, nz)
                    baseAtoms.forEach(atom => {
                        let x = (atom.fx + nx) * lattice_a;
                        let y = (atom.fy + ny) * lattice_a;
                        let z = (atom.fz + nz) * lattice_a;
                        // Use toFixed(4) for cleaner coordinate output
                        xyzBuilder.push(`${atom.element} ${x.toFixed(4)} ${y.toFixed(4)} ${z.toFixed(4)}`);
                        totalAtoms++;
                    });
                }
            }
        }

        // Combine into final XYZ data string
        const xyzData = `${totalAtoms}\nHg0.5Cd0.5Te ${supercell_dim}x${supercell_dim}x${supercell_dim} Supercell (a=${lattice_a} A)\n` + xyzBuilder.join('\n');

        // --- 3Dmol.js Viewer Setup ---
        let viewerElement = document.getElementById('viewer-container');
        let viewer = $3Dmol.createViewer(viewerElement, { backgroundColor: 'white' });

        // Load the atomic data for the supercell
        viewer.addModel(xyzData, 'xyz');

        // Apply ball-and-stick style with specific colors
        // Increase stick radius slightly for better visibility in larger model
        viewer.setStyle({}, {
            stick: { radius: 0.18, colorscheme: 'element' },
            sphere: { scale: 0.3, colorscheme: 'element' }
        });
        // Override colorscheme for specific elements
        viewer.setStyle({elem:'Te'}, {sphere:{color:'yellow'}, stick:{color:'yellow'}});
        viewer.setStyle({elem:'Hg'}, {sphere:{color:'grey'},   stick:{color:'grey'}});
        viewer.setStyle({elem:'Cd'}, {sphere:{color:'blue'},   stick:{color:'blue'}});

        // DO NOT addUnitCell() here, as it would only draw the box for the first 0,0,0 cell.
        // If you wanted a box around the entire supercell, you'd use viewer.addBox().

        // Zoom camera to fit the model
        viewer.zoomTo();

        // Draw the scene
        viewer.render();

        // Optional: Add spinning for larger models to see all sides easily
        // viewer.spin(true);

    }); // End DOMContentLoaded
</script>

</body>
</html>
